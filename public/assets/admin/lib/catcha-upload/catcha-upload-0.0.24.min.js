!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=4)}([function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAABjUlEQVRYhe3UvWsUQRjH8Y9GUU4hFgfXSLBIgo0pYmtjY2sX7GIIgYApkvgPaKFYWBnQwtfyLGzs/BMkneALqURTyFU2EgLJncWOZLmsuzM6IkR/MMzOyz7Pd5797fCv61DF3HFcx9RP1svawTu8wPtcUDcwSGx9rOFwarIjFXNnQ/8R6w3vt3FRUakltLAQgH5ZXcWpnkbsvWB/NZ6rPlilkktWo27oZ3Bfs3+yAyziXnheUFSwMX5OgAGWSxCzeNyUIydAFcRVPKrLkxvgB8QKHobxXACq9ES0WyN0E9ul8dfQTuEa3uJBTKCU33BS/GX1BSPDAX63AhtYxZWq4EFHFdd6BxP40BQ0pQIx6tirwvTw4p8wYZJiPkFLYaDRxNh3cTsHwEmcSUwO4zGbYgB6uIxjiQBvcgHAy8Tk0YoFuCTdA6/xKQdAG68Sk8MTzOcA2MJnhRlT1Hj6WIBvGEtMHq2/fhH9B6jzwHncyZDjRCpAL/TnQsulfil2LcAtnJbX+bt4hs2MMQ+IvgMTJlgKJarF8QAAAABJRU5ErkJggg=="},function(e){e.exports=JSON.parse('{"name":"catcha-upload","version":"0.0.24","description":"","private":true,"scripts":{"build":"cross-env ENV=production webpack","dev":"cross-env ENV=development webpack","watch":"cross-env ENV=development webpack --watch","start":"cross-env ENV=development webpack-dev-server --open"},"author":"","license":"ISC","devDependencies":{"@babel/core":"^7.5.5","@babel/preset-env":"^7.5.5","babel-loader":"^8.0.6","clean-webpack-plugin":"^3.0.0","cross-env":"^5.2.0","css-loader":"^3.2.0","file-loader":"^4.2.0","html-webpack-plugin":"^3.2.0","mini-css-extract-plugin":"^0.8.0","optimize-css-assets-webpack-plugin":"^5.0.3","style-loader":"^1.0.0","terser-webpack-plugin":"^1.4.1","url-loader":"^2.1.0","webpack":"^4.39.1","webpack-cli":"^3.3.6","webpack-dev-server":"^3.8.0"},"dependencies":{}}')},function(e,t,r){},,function(e,t,r){"use strict";r.r(t);r(2);var n=r(0),i=r.n(n),a=function(e){return new Promise(function(t,r){var n=new FileReader;n.readAsDataURL(e),n.onload=function(e){t(e.target.result)}})},s=function(e){return e.search(/^data:image\/(png|jpe?g|gif|svg)/)>-1},o=function(e,t){var r=t?1e3:1024;if(Math.abs(e)<r)return e+" B";var n=t?["KB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],i=-1;do{e/=r,++i}while(Math.abs(e)>=r&&i<n.length-1);return e.toFixed(1)+" "+n[i]};function l(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,t){this.element=document.createElement("div"),this.id=Math.random().toString(36).substr(2,16),this.file=t,this.fileName=t.name,this.fileSize=o(t.size,!0),this.errors=[],this.fileStatus=e,this.progressBarElement=null,this.percentageElement=null,this.renderLayout()}c.prototype.renderLayout=function(){var e,t;this.element.classList.add("cau-file-status-bar"),this.element.dataset.id=this.id,this.element.innerHTML='\n    <div class="cau-file-preview"></div>\n    <div class="cau-file-status">\n      <div class="cau-file-info">\n        <div class="cau-file-name">'.concat(this.fileName,'</div>\n        <div class="cau-file-size">').concat(this.fileSize,'</div>\n      </div>\n      <div class="cau-file-progressbar-box">\n      </div>\n    </div>\n  '),e=this.element.querySelector(".cau-file-preview"),t=this.file,e.style.backgroundImage='url("'.concat(i.a,'")'),a(t).then(function(t){s(t)&&(e.style.backgroundImage='url("'.concat(t,'")'))})},c.prototype.renderStatusReady=function(){var e,t;return this.element.querySelector(".cau-file-progressbar-box").innerHTML='\n    <div class="cau-file-progressbar-menu">\n      <button type="button" class="cau-file-progressbar-remove-btn">Remove</button>\n    </div>\n    <div class="cau-file-progressbar-percentage">ready</div>\n  ',e=this.element.querySelector(".cau-file-progressbar-remove-btn"),t=this,e.addEventListener("click",function(e){e.preventDefault(),t.hasErrors()?t.fileStatus.removeFile("filesDeclined",t):t.fileStatus.removeFile("filesReady",t),t.fileStatus.element.querySelector("[data-id='".concat(t.id,"']")).remove(),t.fileStatus.changeFilesCounter()}),this.element},c.prototype.renderStatusDeclined=function(){var e=this.element.querySelector(".cau-file-progressbar-box"),t=document.createElement("ul");return t.classList.add("cau-file-error"),function(e,t){var r=!0,n=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done);r=!0){var o=a.value,l=document.createElement("li");l.innerText=o.msg,e.appendChild(l)}}catch(e){n=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(n)throw i}}}(t,this.errors),e.appendChild(t),this.element},c.prototype.renderStatusInProgress=function(){this.element.querySelector(".cau-file-progressbar-box").innerHTML='\n    <div class="cau-file-progressbar-back">\n      <div class="cau-file-progressbar"></div>\n    </div>\n    <div class="cau-file-progressbar-percentage">0%</div>\n  ',this.progressBarElement=this.element.querySelector(".cau-file-progressbar"),this.percentageElement=this.element.querySelector(".cau-file-progressbar-percentage")},c.prototype.changePercentage=function(e){this.progressBarElement.style.width=e+"%",this.percentageElement.innerText=e+"%"},c.prototype.complete=function(){this.element.classList.add("completed"),this.progressBarElement.classList.add("completed"),this.percentageElement.classList.add("completed")},c.prototype.addErrors=function(e){this.errors=[].concat(l(this.errors),l(e))},c.prototype.hasErrors=function(){return!!this.errors.length};var u=c;function d(e){this.element=document.createElement("div"),this.filesUploaded=[],this.filesDeclined=[],this.filesReady=[]}function p(e,t){e.children.length?e.insertBefore(t,e.firstChild):e.appendChild(t)}d.prototype.render=function(){return this.element.classList.add("cau-status-section"),this.element.innerHTML='\n    <div class="cau-tab-menu">\n      <a href="#" class="cau-tab-item active" data-tab="cau-files-ready">Ready <span class="cau-files-ready-counter">(0)</span></a>\n      <a href="#" class="cau-tab-item cau-color-danger" data-tab="cau-files-declined">Declined <span class="cau-files-declined-counter">(0)</span></a>\n    </div>\n    <div class="cau-files-ready cau-tab active">\n    </div>\n    <div class="cau-files-declined cau-tab">\n    </div>\n  ',function(e,t,r){var n=!0,i=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(n=(s=o.next()).done);n=!0){s.value.addEventListener("click",function(n,i){n.preventDefault();var a="span"===n.target.localName?n.target.parentElement:n.target,s=!0,o=!1,l=void 0;try{for(var c,u=t[Symbol.iterator]();!(s=(c=u.next()).done);s=!0){c.value.classList.remove("active")}}catch(e){o=!0,l=e}finally{try{s||null==u.return||u.return()}finally{if(o)throw l}}a.classList.add("active");var d=!0,p=!1,f=void 0;try{for(var h,v=r[Symbol.iterator]();!(d=(h=v.next()).done);d=!0){h.value.classList.remove("active")}}catch(e){p=!0,f=e}finally{try{d||null==v.return||v.return()}finally{if(p)throw f}}e.querySelector("."+a.dataset.tab).classList.add("active")})}}catch(e){i=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw a}}}(this.element,this.element.querySelectorAll(".cau-tab-item"),this.element.querySelectorAll(".cau-tab")),this.element},d.prototype.createFileStatusBar=function(e){return new u(this,e)},d.prototype.addFileReady=function(e){var t=this.createFileStatusBar(e),r=this.element.querySelector(".cau-files-ready");this.filesReady.push(t),p(r,t.renderStatusReady())},d.prototype.addFileDeclined=function(e,t){var r=this.createFileStatusBar(e);r.addErrors(t);var n=this.element.querySelector(".cau-files-declined");this.filesDeclined.push(r),p(n,r.renderStatusDeclined())},d.prototype.addFileUploaded=function(e){this.filesUploaded.push(e)},d.prototype.clearFilesReady=function(){this.filesReady=[]},d.prototype.removeFile=function(e,t){this[e]=this[e].filter(function(e){if(e!==t)return e})},d.prototype.changeFilesCounter=function(){var e=this.element.querySelector(".cau-files-ready-counter"),t=this.element.querySelector(".cau-files-declined-counter");e.innerText="(".concat(this.filesReady.length,")"),t.innerText="(".concat(this.filesDeclined.length,")")};var f=d;function h(e){this.msg=e}function v(e,t,r){this.catchaUpload=e,this.errors=[],t&&this.validate(t,r)}v.prototype.isValidated=function(e){return!this.errors.length},v.prototype.getErrors=function(){return this.errors},v.prototype.validate=function(e,t){!function(e,t,r){e&&t.size>e&&r.push(new h("Over maximum file size."))}(this.catchaUpload.rules.maximumFileSize,e,this.errors),function(e,t,r){t.size<e&&r.push(new h("Less minimum file size."))}(this.catchaUpload.rules.minimumFileSize,e,this.errors),function(e,t,r){e&&t>=e&&r.push(new h("Overflow."))}(this.catchaUpload.rules.maximumFileNumber,t,this.errors)};function y(e,t){t.renderStatusInProgress()}function m(e,t){var r=Math.round(e.loaded/e.total*99);t.changePercentage(r)}function g(e,t){t.complete(),t.changePercentage(100),t.fileStatus.addFileUploaded(t)}var b=function(e,t,r){var n=function(e,t){var r=new XMLHttpRequest;return"withCredentials"in r?r.open(e,t,!0):"undefined"!=typeof XDomainRequest?(r=new XDomainRequest).open(e,t):r=null,r}("POST",e);n?(n.addEventListener("loadstart",function(e){return y(0,r)},!1),n.upload.addEventListener("progress",function(e){return m(e,r)},!1),n.addEventListener("load",function(e){return g(0,r)},!1),n.addEventListener("error",function(e){console.log("error")},!1),n.addEventListener("abort",function(e){console.log("abort")},!1),n.open("POST",e),n.send(t)):alert("CORS not supported")},S=function(e,t){var r=e.file,n=r.name,i=r.type;AWS.config.region=t.region,AWS.config.credentials=new AWS.CognitoIdentityCredentials({IdentityPoolId:t.IdentityPoolId});var a=new AWS.S3({params:{Bucket:t.bucket}});y(0,e),a.upload({Key:n,Body:r,ContentType:i,ACL:"public-read"},{partSize:10485760,queueSize:2}).on("httpUploadProgress",function(t){m(t,e)}).send(function(t){g(0,e)})};function w(e,t){this.catchaUpload=e,this.inputFileName=e.inputFileName,this.filesReady=t}w.prototype.upload=function(){for(var e=0;e<this.filesReady.length;e++)this.uploadSingleFile(this.filesReady[e])},w.prototype.uploadSingleFile=function(e){var t=new FormData;t.append(this.inputFileName,e.file),b(this.catchaUpload.url,t,e)},w.prototype.uploadToS3=function(e){for(var t=0;t<this.filesReady.length;t++)S(this.filesReady[t],e)};var A=function(){return"Drag your files here or click in this area"},F=function(){return"Drop your files here"};function E(e){this.catchaUpload=e,this.target=e.target,this.inputFileName=e.inputFileName}E.prototype.render=function(){this.target.innerHTML='\n    <div class="cau-wrapper">\n      <form class="cau-form">\n        <input type="file" id="'.concat(this.inputFileName,'" name="').concat(this.inputFileName,'" class="cau-input-file" multiple/>\n        <div class="cau-form-msg">\n          <span>').concat(A(),'</span>\n        </div>\n        <button type="submit" class="cau-submit">Upload</button>\n      </form>\n    </div>\n  ')},E.prototype.init=function(){this.render();var e=this.catchaUpload,t=this.target,r=t.querySelector(".cau-wrapper"),n=t.querySelector(".cau-form"),i=t.querySelector(".cau-input-file"),a=t.querySelector(".cau-form-msg > span"),s=new f(e);t.style.width=e.style.width,n.style.height=e.style.dropZoneHeight,r.appendChild(s.render()),i.addEventListener("dragenter",function(e){a.innerText=F(),n.classList.add("dragentered")}),i.addEventListener("dragleave",function(e){a.innerText=A(),n.classList.remove("dragentered")}),i.addEventListener("change",function(t){t.preventDefault(),a.innerText=A(),n.classList.remove("dragentered");var r=i.files,o=!0,l=!1,c=void 0;try{for(var u,d=r[Symbol.iterator]();!(o=(u=d.next()).done);o=!0){var p=u.value,f=new v(e,p,s.filesUploaded.length+s.filesReady.length);f.isValidated()?s.addFileReady(p):s.addFileDeclined(p,f.getErrors())}}catch(e){l=!0,c=e}finally{try{o||null==d.return||d.return()}finally{if(l)throw c}}s.changeFilesCounter(),i.value=""}),n.addEventListener("submit",function(t){if(t.preventDefault(),s.filesReady.length){var r=new w(e,s.filesReady);"server"===e.storageType?r.upload():"s3"===e.storageType&&r.uploadToS3({IdentityPoolId:e.s3.IdentityPoolId,region:e.s3.region,bucket:e.s3.bucket}),s.clearFilesReady(),s.changeFilesCounter()}})};var B=E,L=r(1);function x(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?x(r,!0).forEach(function(t){R(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function R(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P(e,t){this.version=L.version,this.target=null,this.url="http://localhost:8080",this.inputFileName="media",this.style={width:"500px",dropZoneHeight:"150px"},this.rules={maximumFileSize:10485760,minimumFileSize:0,maximumFileNumber:0},this.storageType="server",this.s3={IdentityPoolId:"",region:"",bucket:""},e&&this.setTarget(e),t&&this.setOpts(t),this.render()}P.prototype.setTarget=function(e){this.target=e},P.prototype.setOpts=function(e){var t=Object.assign({},this,O({},e,{style:O({},this.style,{},e.style),rules:O({},this.rules,{},e.rules),s3:O({},this.s3,{},e.s3)}));Object.assign(this,t)},P.prototype.render=function(){new B(this).init()};window.CatchaUpload=function(e,t){return new P(e,t)}}]);